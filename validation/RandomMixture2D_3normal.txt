restart:
with(Statistics):
assume(m11, real, m12, real, m13, real, m21, real, m22, real, m23, real);
valnum := m11 = 1, m12 = -2, m13 = 1, m21 = 1, m22 = 1, m23 = -3;
p1 := PDF(RandomVariable(Normal(0, 1)), x1);
p2 := PDF(RandomVariable(Normal(0, 1)), x2);
p3 := PDF(RandomVariable(Normal(0, 1)), x3);
N := Matrix(3, 3, [m11, m12, m13, m21, m22, m23, 0, 0, 1]);
with(LinearAlgebra):
R := MatrixInverse(N);
x := R . Vector([z1, z2, z3]);
pdfZ := subs(x1 = x[1], p1) * subs(x2 = x[2], p2) * subs(x3 = x[3], p3) * abs(Determinant(R));
pdfY := int(pdfZ, z3 = -infinity..infinity);
simplify(subs(valnum, pdfY));

# Gaussian case
C := simplify(subs(valnum, N . Transpose(N)));
Q := MatrixInverse(C);
z := Matrix(3, 1, [z1, z2, z3]);
pdfZTh := 1/((2 * Pi)^(3/2) * sqrt(abs(Determinant(C)))) * exp(expand(-1/2*(Transpose(z) . Q . z)[1, 1]));

# First marginal
int(int(pdfZTh, z3=-infinity..infinity), z2=-infinity..infinity);
int(int(subs(valnum, pdfZ), z3=-infinity..infinity), z2=-infinity..infinity);
# Second marginal
int(int(pdfZTh, z3=-infinity..infinity), z1=-infinity..infinity);
int(int(subs(valnum, pdfZ), z3=-infinity..infinity), z1=-infinity..infinity);
# Third marginal
int(int(pdfZTh, z2=-infinity..infinity), z1=-infinity..infinity);
int(int(subs(valnum, pdfZ), z2=-infinity..infinity), z1=-infinity..infinity);
# (1,2) marginal
int(pdfZTh, z3=-infinity..infinity);
int(subs(valnum, pdfZ), z3=-infinity..infinity);
# (2,3) marginal
int(pdfZTh, z1=-infinity..infinity);
int(subs(valnum, pdfZ), z1=-infinity..infinity);
# (1,3) marginal
int(pdfZTh, z2=-infinity..infinity);
int(subs(valnum, pdfZ), z2=-infinity..infinity);
