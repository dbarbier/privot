restart:
with(Statistics):
assume(m11, real, m12, real, m13, real, m21, real, m22, real, m23, real);
valnum := m11 = 1, m12 = -2, m13 = 1, m21 = 1, m22 = 1, m23 = -3;
p1 := PDF(RandomVariable(Uniform(0, 1)), x1);
p2 := PDF(RandomVariable(Uniform(0, 1)), x2);
p3 := PDF(RandomVariable(Uniform(0, 1)), x3);
N := Matrix(3, 3, [m11, m12, m13, m21, m22, m23, 0, 0, 1]);
with(LinearAlgebra):
R := MatrixInverse(N);
x := R . Vector([z1, z2, z3]);
pdfZ := subs(x1 = x[1], p1) * subs(x2 = x[2], p2) * subs(x3 = x[3], p3) * abs(Determinant(R));
pdfZsimp := simplify(subs(valnum, pdfZ)) assuming z3>0, z3<1;
pdfY := int(pdfZsimp, z3 = 0..1);
evalf(subs(z1 = 1, z2 = -0.5, pdfY));
with(plots):
contourplot(pdfY, z1=-3..3, z2=-3..3, grid=[150,150]);
