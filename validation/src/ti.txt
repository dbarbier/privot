> restart:
> p:=(2*Pi)^(-16/2)/sigma1^13/sigma2^3*exp(-1/(2*sigma1^2)*sum((x[i]-1)^
> 2,i=1..13))*exp(-1/(2*sigma2^2)*sum((x[i]-1)^2,i=14..16));

                                 2             2             2
  p := 1/256 exp(-1/2 ((x[1] - 1)  + (x[2] - 1)  + (x[3] - 1)

                     2             2             2             2
         + (x[4] - 1)  + (x[5] - 1)  + (x[6] - 1)  + (x[7] - 1)

                     2             2              2              2
         + (x[8] - 1)  + (x[9] - 1)  + (x[10] - 1)  + (x[11] - 1)

                      2              2    /       2
         + (x[12] - 1)  + (x[13] - 1) )  /  sigma1 )
                                        /

                            2              2              2
                 (x[14] - 1)  + (x[15] - 1)  + (x[16] - 1)     /    8
        exp(-1/2 ------------------------------------------)  /  (Pi
                                        2                    /
                                  sigma2

              13       3
        sigma1   sigma2 )

> dp:=diff(p,sigma1);

         13             %1
  dp := ---- exp(-1/2 -------)
         256                2
                      sigma1

                            2              2              2
                 (x[14] - 1)  + (x[15] - 1)  + (x[16] - 1)     /    8
        exp(-1/2 ------------------------------------------)  /  (Pi
                                        2                    /
                                  sigma2

              14       3                        %1
        sigma1   sigma2 ) + 1/256 %1 exp(-1/2 -------)
                                                    2
                                              sigma1

                            2              2              2
                 (x[14] - 1)  + (x[15] - 1)  + (x[16] - 1)     /    8
        exp(-1/2 ------------------------------------------)  /  (Pi
                                        2                    /
                                  sigma2

              16       3
        sigma1   sigma2 )

                  2             2             2             2
  %1 := (x[1] - 1)  + (x[2] - 1)  + (x[3] - 1)  + (x[4] - 1)

                     2             2             2             2
         + (x[5] - 1)  + (x[6] - 1)  + (x[7] - 1)  + (x[8] - 1)

                     2              2              2              2
         + (x[9] - 1)  + (x[10] - 1)  + (x[11] - 1)  + (x[12] - 1)

                      2
         + (x[13] - 1)

> p_i:=subs(sigma1=tau1,sigma2=tau2,p);

                                   2             2             2
  p_i := 1/256 exp(-1/2 ((x[1] - 1)  + (x[2] - 1)  + (x[3] - 1)

                     2             2             2             2
         + (x[4] - 1)  + (x[5] - 1)  + (x[6] - 1)  + (x[7] - 1)

                     2             2              2              2
         + (x[8] - 1)  + (x[9] - 1)  + (x[10] - 1)  + (x[11] - 1)

                      2              2    /     2
         + (x[12] - 1)  + (x[13] - 1) )  /  tau1 )
                                        /

                            2              2              2
                 (x[14] - 1)  + (x[15] - 1)  + (x[16] - 1)     /    8
        exp(-1/2 ------------------------------------------)  /  (Pi
                                       2                     /
                                   tau2

            13     3
        tau1   tau2 )

> collect(expand(p/p_i),exp);

           13           x[1]         x[2]         x[3]
  exp(- ---------) exp(-------) exp(-------) exp(-------)
                2            2            2            2
        2 sigma1       sigma1       sigma1       sigma1

             x[4]         x[5]         x[6]         x[7]
        exp(-------) exp(-------) exp(-------) exp(-------)
                  2            2            2            2
            sigma1       sigma1       sigma1       sigma1

             x[8]         x[9]         x[10]        x[11]
        exp(-------) exp(-------) exp(-------) exp(-------)
                  2            2            2            2
            sigma1       sigma1       sigma1       sigma1

                                                2                 2
             x[12]        x[13]             x[1]              x[2]
        exp(-------) exp(-------) exp(-1/2 -------) exp(-1/2 -------)
                  2            2                 2                 2
            sigma1       sigma1            sigma1            sigma1

                      2                 2                 2
                  x[3]              x[4]              x[5]
        exp(-1/2 -------) exp(-1/2 -------) exp(-1/2 -------)
                       2                 2                 2
                 sigma1            sigma1            sigma1

                      2                 2                 2
                  x[6]              x[7]              x[8]
        exp(-1/2 -------) exp(-1/2 -------) exp(-1/2 -------)
                       2                 2                 2
                 sigma1            sigma1            sigma1

                      2                 2                 2
                  x[9]             x[10]             x[11]
        exp(-1/2 -------) exp(-1/2 -------) exp(-1/2 -------)
                       2                 2                 2
                 sigma1            sigma1            sigma1

                      2                 2                 2
                 x[12]             x[13]             x[14]
        exp(-1/2 -------) exp(-1/2 -------) exp(-1/2 -------)
                       2                 2                 2
                 sigma1            sigma1            sigma2

                                                    2
             x[14]             3               x[15]         x[15]
        exp(-------) exp(- ---------) exp(-1/2 -------) exp(-------)
                  2                2                 2            2
            sigma2         2 sigma2            sigma2       sigma2

                      2                                 /
                 x[16]         x[16]       13     3   / |      13
        exp(-1/2 -------) exp(-------) tau1   tau2   /  |sigma1
                       2            2               /   |
                 sigma2       sigma2                    \

              3         13         x[1]       x[2]       x[3]
        sigma2  exp(- -------) exp(-----) exp(-----) exp(-----)
                            2          2          2          2
                      2 tau1       tau1       tau1       tau1

            x[4]       x[5]       x[6]       x[7]       x[8]
        exp(-----) exp(-----) exp(-----) exp(-----) exp(-----)
                2          2          2          2          2
            tau1       tau1       tau1       tau1       tau1

            x[9]       x[10]      x[11]      x[12]      x[13]
        exp(-----) exp(-----) exp(-----) exp(-----) exp(-----)
                2          2          2          2          2
            tau1       tau1       tau1       tau1       tau1

                     2               2               2
                 x[1]            x[2]            x[3]
        exp(-1/2 -----) exp(-1/2 -----) exp(-1/2 -----)
                     2               2               2
                 tau1            tau1            tau1

                     2               2               2
                 x[4]            x[5]            x[6]
        exp(-1/2 -----) exp(-1/2 -----) exp(-1/2 -----)
                     2               2               2
                 tau1            tau1            tau1

                     2               2               2
                 x[7]            x[8]            x[9]
        exp(-1/2 -----) exp(-1/2 -----) exp(-1/2 -----)
                     2               2               2
                 tau1            tau1            tau1

                      2                2                2
                 x[10]            x[11]            x[12]
        exp(-1/2 ------) exp(-1/2 ------) exp(-1/2 ------)
                     2                2                2
                 tau1             tau1             tau1

                      2                2
                 x[13]            x[14]       x[14]           3
        exp(-1/2 ------) exp(-1/2 ------) exp(-----) exp(- -------)
                     2                2           2              2
                 tau1             tau2        tau2         2 tau2

                      2                           2            \
                 x[15]       x[15]           x[16]       x[16] |
        exp(-1/2 ------) exp(-----) exp(-1/2 ------) exp(-----)|
                     2           2               2           2 |
                 tau2        tau2            tau2        tau2  /

> 
