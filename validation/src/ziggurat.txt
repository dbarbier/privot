> restart:
> st:=time();
> Digits:=30:
> with(linalg):
> f:=exp(-t^2/2);
> invf:=solve(subs(t=u,f)=t,u)[1];
> N:=128:
> z:=proc(r)
>      local x,v,i;
>      x:=vector(N);
>      x[N]:=r;
>      v:=r*subs(t=r,f)+int(f,t=r..infinity);
>      for i from N-1 by -1 to 1 do
>        x[i]:=subs(t=v/x[i+1]+subs(t=x[i+1],f),invf);
>      od:
>      return (v-x[1]+x[1]*subs(t=x[1],f));
> end:
> points:=proc(r)
>      local x,v,i;
>      x:=vector(N);
>      x[N]:=r;
>      v:=evalf(r*subs(t=r,f)+int(f,t=r..infinity));
>      for i from N-1 by -1 to 1 do
>        x[i]:=eval(subs(t=v/x[i+1]+subs(t=x[i+1],f),invf));
>      od:
>      return x;
> end:

                             st := 19.609


                                        2
                                       t
                           f := exp(- ----)
                                       2


                                          1/2
                        invf := (-2 ln(t))

> eps:=1e-20:
> rmin:=3.4:
> zmin:=evalf(z(rmin)):
> continue:=true;
> step:=0.1:
> while continue do
>   while (Im(zmin) <> 0) do
>     rmin:=rmin+step;
>     zmin:=evalf(z(rmin)):
>     print([rmin,zmin]);
>   od:
>   step:=step*0.5;
>   while ((zmin<0) and (Im(zmin) = 0.0)) do
>     print([rmin,zmin]);
>     rmin:=rmin-step;
>     zmin:=evalf(z(rmin)):
>   od:
>   continue:=Im(zmin)<>0;
> od:
> rmax:=3.5:
> zmax:=evalf(z(rmax)):
> while (rmax-rmin>eps) do
>   m:=0.5*(rmax+rmin);
>   zm:=evalf(z(m));
>   if zm*zmin>0 then
>     rmin:=m;
>     zmin:=zm;
>   else
>     rmax:=m;
>     zmax:=zm;
>   fi:
>   print([m,zm]);
> od:
> r:=0.5*(rmin+rmax);
> v:=evalf(r*subs(t=r,f)+int(f,t=r..infinity));
> evalf(100*(1-int(f,t=0..infinity)/v/(N+1)));
> time()-st;

                           continue := true


               [3.5, -0.311792208785566848875990248026]


               [3.5, -0.311792208785566848875990248026]


              [3.45, -0.026852880697952826671234025455]


              [3.45, -0.026852880697952826671234025455]


              [3.45, -0.026852880697952826671234025455]


              [3.450, -0.026852880697952826671234025455]


              [3.450, -0.026852880697952826671234025455]


             [3.4500, -0.026852880697952826671234025455]


             [3.4500, -0.026852880697952826671234025455]


            [3.471875, -0.153081080990288697177520760144]


            [3.4578125, -0.071779667717385269948785934005]


           [3.45078125, -0.031289989910190834592877768001]


           [3.447265625, -0.011579643457509481260812358803]


          [3.4455078125, -0.002175851758006783220974044037]


          [3.44462890625, 0.002256735613253380424646977045]


          [3.445068359375, 0.000073412955539217839879165122]


         [3.4452880859375, -0.001044108118574164890822836116]


        [3.44517822265625, -0.000483446100497147330866653588]


        [3.445123291015625, -0.000204524377980705171102147066]


       [3.4450958251953125, -0.000065430465509012622230029971]


                                                           -5
       [3.44508209228515625, 0.4022837256970895879765017 10  ]


      [3.445088958740234375, -0.000030695951449192052085702345]


      [3.4450855255126953125, -0.000013334587021732029252634313]


                                                             -5
     [3.44508380889892578125, -0.4655381811589424077024346 10  ]


                                                             -6
     [3.445082950592041015625, -0.316148940489725396822865 10  ]


                                                              -5
     [3.4450825214385986328125, 0.1853375001091773118231396 10  ]


                                                              -6
     [3.44508273601531982421875, 0.768620739932761131449043 10  ]


                                                              -6
    [3.445082843303680419921875, 0.226237826994343510741743 10  ]


                                                               -7
    [3.4450828969478607177734375, -0.44955074946371630009425 10  ]


                                                               -7
    [3.44508287012577056884765625, 0.90641496476426589498257 10  ]


                                                               -7
   [3.445082883536815643310546875, 0.22843240877873785271136 10  ]


                                                                -7
  [3.4450828902423381805419921875, -0.11055909506070327719124 10  ]


                                                                -8
   [3.44508288688957691192626953125, 0.5893667567950500138776 10  ]


                                                                -8
  [3.44508288856595754623413085937, -0.2581120498548236288025 10  ]


                                                                -8
   [3.44508288772776722908020019530, 0.1656273652329115718248 10  ]


                                                                -9
   [3.44508288814686238765716552733, -0.462423393702572388832 10  ]


                                                               -9
   [3.44508288793731480836868286131, 0.596925136665019645283 10  ]


                                                              -10
   [3.44508288804208859801292419432, 0.67250873319160497498 10   ]


                                                                -9
   [3.44508288809447549283504486082, -0.197586259732221744011 10  ]


                                                               -10
   [3.44508288806828204542398452757, -0.65167693091659570847 10   ]


                                                              -11
    [3.44508288805518532171845436094, 0.1041590142468226701 10   ]


                                                               -10
   [3.44508288806173368357121944425, -0.32063051467416231233 10   ]


                                                               -10
   [3.44508288805845950264483690259, -0.15510730660679142055 10   ]


                                                              -11
   [3.44508288805682241218164563177, -0.7234570258656742643 10   ]


                                                              -11
   [3.44508288805600386695004999635, -0.3096490057982079252 10   ]


                                                              -11
   [3.44508288805559459433425217865, -0.1027449957728881592 10   ]


                                                            -14
     [3.44508288805538995802635326979, 0.7070092376683785 10   ]


                                                              -12
    [3.44508288805549227618030272422, -0.510189932674346155 10   ]


                                                              -12
    [3.44508288805544111710332799701, -0.251559920148393038 10   ]


                                                              -12
    [3.44508288805541553756484063340, -0.122244913885745087 10   ]


                                                             -13
    [3.44508288805540274779559695160, -0.57587410754503330 10   ]


                                                             -13
    [3.44508288805539635291097511070, -0.25258659188902893 10   ]


                                                             -14
     [3.44508288805539315546866419025, -0.9094283406107926 10   ]


                                                             -14
     [3.44508288805539155674750873002, -0.1012095514711662 10   ]


                                                            -14
     [3.44508288805539075738693099991, 0.3028998430986092 10   ]


                                                            -14
     [3.44508288805539115706721986497, 0.1008451458137229 10   ]


                                                           -17
      [3.44508288805539135690736429749, -0.1822028287225 10   ]


                                                            -15
      [3.44508288805539125698729208122, 0.503314714925063 10   ]


                                                            -15
      [3.44508288805539130694732818935, 0.250746343318983 10   ]


                                                            -15
      [3.44508288805539133192734624342, 0.124462157515871 10   ]


                                                           -16
      [3.44508288805539134441735527045, 0.61320064614406 10   ]


                                                           -16
      [3.44508288805539135066235978396, 0.29749018163637 10   ]


                                                           -16
      [3.44508288805539135378486204072, 0.13963494938300 10   ]


                                                           -17
       [3.44508288805539135534611316910, 0.6070733325554 10   ]


                                                           -17
       [3.44508288805539135612673873329, 0.2124352519261 10   ]


                                                          -18
       [3.44508288805539135651705151538, 0.151162116056 10   ]


                                                           -18
       [3.44508288805539135671220790643, -0.835433085551 10   ]


                                                           -18
       [3.44508288805539135661462971091, -0.342135484724 10   ]


                                                          -19
       [3.44508288805539135656584061315, -0.95486684372 10   ]


                                                          -19
        [3.44508288805539135654144606427, 0.27837715801 10   ]


                                                          -19
       [3.44508288805539135655364333872, -0.33824484295 10   ]


                                                          -20
        [3.44508288805539135654754470150, -0.2993384285 10   ]


                 r := 3.44508288805539135654449538289


               v := 0.00983490811172757998880606474955


                    1.2129716191583968202392378292


                               206.427

> t:=points(r):
> y:=vector(N+2):
> y[1]:=0:
> for i from 2 to N+1 do
>   y[i]:=t[i-1];
> od:
> y[N+2]:=evalf(v/subs(t=r,f)):
> z:=vector(N+1):
> for i from 1 to N+1 do
>   z[i]:=y[i]/y[i+1];
> od:
> print(z);

  [0., 0.750484775353838553484969850043,

        0.850740271310955168539797476445,

        0.893433541969631939167066002439,

        0.917015181837094471851335493153,

        0.931941203234046233441298028733,

        0.942225689827803086945282581056,

        0.949736532992396229158449917333,

        0.955459380775071654971678008833,

        0.959962976643589437257667346996,

        0.963598275031758611303047864447,

        0.966593473467949497522283939333,

        0.969103315737874152720557392852,

        0.971236417555650662146408519772,

        0.973071247290683962507094254337,

        0.974665898140297597377304564176,

        0.976064293086860561017929573224,

        0.977300253883645249170475123945,

        0.978400244899316179173188425569,

        0.979385269129977846895884043302,

        0.980272206900904494815390564396,

        0.981074779362329241400634997295,

        0.981804253938740083291033345358,

        0.982469968882383589521668758583,

        0.983079728809119850562796554795,

        0.983640106766412054356146072398,

        0.984156677615944084392929857459,

        0.984634200280007552311796735515,

        0.985076761458307086707253212313,

        0.985487889991653471429663256532,

        0.985870648634019490358385815715,

        0.986227708271493343086583402375,

        0.986561408382272362985077361984,

        0.986873806622761920341336293274,

        0.987166719753625799389459567589,

        0.987441757619090675912393772106,

        0.987700351516051174211224554768,

        0.987943778003453440265050048019,

        0.988173178983434816520165815368,

        0.988389578716739479383699175238,

        0.988593898303624926534040096469,

        0.988786968058724293246032191279,

        0.988969538127397455898436508912,

        0.989142287626960404173170844597,

        0.989305832545044324977737622638,

        0.989460732586336934407985727862,

        0.989607497125912170683173044980,

        0.989746590400581327272272451975,

        0.989878436047901646747803160708,

        0.990003421084648827869197604239,

        0.990121899401909443020286447879,

        0.990234194841858232813880454444,

        0.990340603911263982506239462637,

        0.990441398178427316016322972125,

        0.990536826393283914925721684389,

        0.990627116364558512218324337623,

        0.990712476622928023181406791844,

        0.990793097894984079572175093174,

        0.990869154409244076145976128873,

        0.990940805052437824691268287474,

        0.991008194391705548082954937064,

        0.991071453576109215637707296064,

        0.991130701128922528307152229819,

        0.991186043640474608746669498017,

        0.991237576369836074033189634373,

        0.991285383762317554082871105898,

        0.991329539888568903748275039752,

        0.991370108809995454035219189473,

        0.991407144874221943150024047055,

        0.991440692943413945013043999353,

        0.991470788557391074579718311726,

        0.991497458032617503483410551001,

        0.991520718497315401540555107636,

        0.991540577862097828628588285611,

        0.991557034724640724341601679445,

        0.991570078205989141038468359572,

        0.991579687715098995526722137843,

        0.991585832637127947522049524329,

        0.991588471939779518821684067585,

        0.991587553690640507148992013935,

        0.991583014476894319513703858007,

        0.991574778716995497249215923087,

        0.991562757851797002828992213523,

        0.991546849400162799407295751574,

        0.991526935861188886574791544186,

        0.991502883441690831444489168144,

        0.991474540583463335923580694623,

        0.991441736259812196096950028863,

        0.991404278004792265983740672627,

        0.991361949631191261607889802980,

        0.991314508584238996353362687132,

        0.991261682866858262508333044405,

        0.991203167458441781253777050367,

        0.991138620131902842410876661610,

        0.991067656552139074390092217899,

        0.990989844511792319927328343055,

        0.990904697125582941945109300521,

        0.990811664760263111407350456154,

        0.990710125420284608160345942834,

        0.990599373235399951429113359060,

        0.990478604599807611123088277090,

        0.990346901385037190355276297326,

        0.990203210479193398963460161789,

        0.990046318677290513694722835952,

        0.989874821637971854574784332163,

        0.989687085197041986702889368351,

        0.989481196737866229216740827939,

        0.989254903487686985183950871399,

        0.989005533422740516025904697311,

        0.988729892746066823168948592841,

        0.988424131369219266125861236354,

        0.988083564029399232263953634600,

        0.987702428858508882825722518646,

        0.987273556123533683467427764224,

        0.986787905274353495741507623455,

        0.986233904410023291038018271182,

        0.985596485459788251551070665927,

        0.984855636576794042676975880029,

        0.983984161793717454104724720040,

        0.982944085941803527491004884902,

        0.981680632603656288469381808499,

        0.980111601026471711171610577703,

        0.978107394117398550145114447318,

        0.975450319596402797690182574081,

        0.971742413337712360174408714492,

        0.966163908091604482763906551568,

        0.956686237014236193571274296719,

        0.936329102386070277297433094023,

        0.927249206800360320095099544455]

> writeto("zigAbs.txt");print(y);writeto("zigRat.txt");print(z);writeto(
> terminal);
> vector([.69828363320908991, .78118354989999061, .79370592389489407,
> 0]);

  [0.69828363320908991, 0.78118354989999061, 0.79370592389489407, 0]

> vector([.75048477535383857, .85074027131095516, .89343354196963194,
> .91701518183709447, .93194120323404624, .94222568982780309,
> .94973653299239623, .95545938077507166, .95996297664358943,
> .96359827503175862, .96659347346794949, .96910331573787415,
> .97123641755565066, .97307124729068396, .97466589814029760,
> .97606429308686056, .97730025388364525, .97840024489931618,
> .97938526912997784, .98027220690090450, .98107477936232924,
> .98180425393874008, .98246996888238359, .98307972880911985,
> .98364010676641205, .98415667761594405, .98463420028000756,
> .98507676145830715, .98548788999165345, .98587064863401946,
> .98622770827149339, .98656140838227233, .98687380662276195,
> .98716671975362574, .98744175761909067, .98770035151605120,
> .98794377800345342, .98817317898343486, .98838957871673949,
> .98859389830362490, .98878696805872424, .98896953812739748,
> .98914228762696040, .98930583254504435, .98946073258633692,
> .98960749712591216, .98974659040058136, .98987843604790162,
> .99000342108464880, .99012189940190944, .99023419484185828,
> .99034060391126399, .99044139817842731, .99053682639328391,
> .99062711636455849, .99071247662292805, .99079309789498403,
> .99086915440924409, .99094080505243783, .99100819439170557,
> .99107145357610920, .99113070112892251, .99118604364047460,
> .99123757636983612, .99128538376231757, .99132953988856886,
> .99137010880999548, .99140714487422192, .99144069294341396,
> .99147078855739107, .99149745803261747, .99152071849731542,
> .99154057786209781, .99155703472464074, .99157007820598915,
> .99157968771509899, .99158583263712792, .99158847193977956,
> .99158755369064052, .99158301447689427, .99157477871699552,
> .99156275785179700, .99154684940016281, .99152693586118888,
> .99150288344169082, .99147454058346333, .99144173625981221,
> .99140427800479225, .99136194963119127, .99131450858423899,
> .99126168286685828, .99120316745844180, .99113862013190281,
> .99106765655213910, .99098984451179232, .99090469712558292,
> .99081166476026313, .99071012542028460, .99059937323539995,
> .99047860459980760, .99034690138503720, .99020321047919340,
> .99004631867729052, .98987482163797186, .98968708519704195,
> .98948119673786624, .98925490348768697, .98900553342274055,
> .98872989274606682, .98842413136921927, .98808356402939922,
> .98770242885850886, .98727355612353372, .98678790527435347,
> .98623390441002328, .98559648545978825, .98485563657679404,
> .98398416179371746, .98294408594180356, .98168063260365628,
> .98011160102647170, .97810739411739857, .97545031959640279,
> .97174241333771234, .96616390809160447, .95668623701423621,
> .93632910238607026, 0]);

  [0.75048477535383857, 0.85074027131095516, 0.89343354196963194,

        0.91701518183709447, 0.93194120323404624, 0.94222568982780309,

        0.94973653299239623, 0.95545938077507166, 0.95996297664358943,

        0.96359827503175862, 0.96659347346794949, 0.96910331573787415,

        0.97123641755565066, 0.97307124729068396, 0.97466589814029760,

        0.97606429308686056, 0.97730025388364525, 0.97840024489931618,

        0.97938526912997784, 0.98027220690090450, 0.98107477936232924,

        0.98180425393874008, 0.98246996888238359, 0.98307972880911985,

        0.98364010676641205, 0.98415667761594405, 0.98463420028000756,

        0.98507676145830715, 0.98548788999165345, 0.98587064863401946,

        0.98622770827149339, 0.98656140838227233, 0.98687380662276195,

        0.98716671975362574, 0.98744175761909067, 0.98770035151605120,

        0.98794377800345342, 0.98817317898343486, 0.98838957871673949,

        0.98859389830362490, 0.98878696805872424, 0.98896953812739748,

        0.98914228762696040, 0.98930583254504435, 0.98946073258633692,

        0.98960749712591216, 0.98974659040058136, 0.98987843604790162,

        0.99000342108464880, 0.99012189940190944, 0.99023419484185828,

        0.99034060391126399, 0.99044139817842731, 0.99053682639328391,

        0.99062711636455849, 0.99071247662292805, 0.99079309789498403,

        0.99086915440924409, 0.99094080505243783, 0.99100819439170557,

        0.99107145357610920, 0.99113070112892251, 0.99118604364047460,

        0.99123757636983612, 0.99128538376231757, 0.99132953988856886,

        0.99137010880999548, 0.99140714487422192, 0.99144069294341396,

        0.99147078855739107, 0.99149745803261747, 0.99152071849731542,

        0.99154057786209781, 0.99155703472464074, 0.99157007820598915,

        0.99157968771509899, 0.99158583263712792, 0.99158847193977956,

        0.99158755369064052, 0.99158301447689427, 0.99157477871699552,

        0.99156275785179700, 0.99154684940016281, 0.99152693586118888,

        0.99150288344169082, 0.99147454058346333, 0.99144173625981221,

        0.99140427800479225, 0.99136194963119127, 0.99131450858423899,

        0.99126168286685828, 0.99120316745844180, 0.99113862013190281,

        0.99106765655213910, 0.99098984451179232, 0.99090469712558292,

        0.99081166476026313, 0.99071012542028460, 0.99059937323539995,

        0.99047860459980760, 0.99034690138503720, 0.99020321047919340,

        0.99004631867729052, 0.98987482163797186, 0.98968708519704195,

        0.98948119673786624, 0.98925490348768697, 0.98900553342274055,

        0.98872989274606682, 0.98842413136921927, 0.98808356402939922,

        0.98770242885850886, 0.98727355612353372, 0.98678790527435347,

        0.98623390441002328, 0.98559648545978825, 0.98485563657679404,

        0.98398416179371746, 0.98294408594180356, 0.98168063260365628,

        0.98011160102647170, 0.97810739411739857, 0.97545031959640279,

        0.97174241333771234, 0.96616390809160447, 0.95668623701423621,

        0.93632910238607026, 0]

> factor(int(3/4*(1-u^2),u=-1..t));

                                           2
                            (t - 2) (t + 1)
                          - ----------------
                                   4

> 
> 
