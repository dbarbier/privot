> restart:
> z:=delta^2*x^2/(2*(nu+x^2)):
> Pdf:=nu^(nu/2)*GAMMA(nu+1)/(2^nu*exp(delta^2/2)*(nu+x^2)^(nu/2)*GAMMA(
> nu/2))*(sqrt(2)*delta*x*hypergeom([nu/2+1],[3/2],z)/((nu+x^2)*GAMMA((n
> u+1)/2))+hypergeom([(nu+1)/2],[1/2],z)/(sqrt(nu+x^2)*GAMMA(nu/2+1)));
> Pdf2:=exp(-delta^2/2)/sqrt(nu*Pi)/GAMMA(nu/2)*(nu/(nu+x^2))^((nu+1)/2)
> *Sum(GAMMA((nu+j+1)/2)/GAMMA(j+1)*(x*delta*sqrt(2/(nu+x*x)))^j,j=0..in
> finity);

                                /
                                |
           / nu \               |
           |----|               |
           \ 2  /               |
  Pdf := nu       GAMMA(nu + 1) |
                                |
                                |
                                \

                                                        2  2
         1/2                     nu                delta  x
        2    delta x hypergeom([---- + 1], [3/2], -----------)
                                 2                          2
                                                  2 nu + 2 x
        ------------------------------------------------------
                            2         nu
                     (nu + x ) GAMMA(---- + 1/2)
                                      2

                                                2  2  \
                       nu                  delta  x   |     /
           hypergeom([---- + 1/2], [1/2], -----------)|     |
                       2                            2 |     |
                                          2 nu + 2 x  |   / | nu
         + -------------------------------------------|  /  |2
                         2 1/2        nu              | /   \
                  (nu + x )    GAMMA(---- + 1)        |
                                      2               /

                             / nu \            \
                             |----|            |
                 2           \ 2  /            |
            delta          2               nu  |
        exp(------) (nu + x )       GAMMA(----)|
              2                            2   /


                                 / nu       \ /
                                 |---- + 1/2| |
                     2           \ 2        / |
                delta   /  nu   \             |
  Pdf2 := exp(- ------) |-------|             |
                  2     |      2|             |
                        \nu + x /             |
                                              \

                        nu               /         1/2 /   1   \1/2\j
        infinity GAMMA(---- + j/2 + 1/2) |x delta 2    |-------|   |
         -----          2                |             |      2|   |
          \                              \             \nu + x /   /
           )     ----------------------------------------------------
          /                          GAMMA(j + 1)
         -----
         j = 0

        \
        |
        |
        |   / /       1/2        nu  \
        |  /  |(nu Pi)    GAMMA(----)|
        | /   \                  2   /
        |
        /

> lx:=[1.0,5.0,15.0]:
> ldelta:=[-20.0,-5.0,0.0,5.0,20.0]:
> lnu:=[2.5,25.25,200.25]:
> res:=Vector(45):
> res2:=Vector(45):
> ind:=1:
> for inu from 1 to 3 do
>   valnu:=lnu[inu];
>   for idelta from 1 to 5 do
>     valdelta:=ldelta[idelta];
>     for ix from 1 to 3 do
>       valx:=lx[ix];
>       st:=time():
>      
> res[ind]:=evalf[5](Int(subs(nu=valnu,delta=valdelta,Pdf),x=-infinity..
> valx));
> print([valnu, valdelta, valx, res[ind],time()-st]);
>       st:=time():
>      
> res2[ind]:=evalf[5](Int(subs(nu=valnu,delta=valdelta,Pdf2(x)),-infinit
> y..valx));
> print([valnu, valdelta, valx, res2[ind],time()-st]);
>       ind := ind + 1;
>     od:
>   od:
> od:
> 
> convert(res,array);

                   [2.5, -20.0, 1.0, 1.0000, 5.247]


                      /
                     |
                     |            -86 /   1    \1.7500
  [2.5, -20.0, 1.0,  |  0.27078 10    |--------|
                     |                |       2|
                     |                \2.5 + x /
                     |
                    /

        /                             /         1/2 /   1    \1/2\j\
        |infinity GAMMA(1.7500 + j/2) |-20.0 x 2    |--------|   | |
        | -----                       |             |       2|   | |
        |  \                          \             \2.5 + x /   / |
        |   )     -------------------------------------------------|
        |  /                        GAMMA(j + 1)                   |
        | -----                                                    |
        \ j = 0                                                    /

        dFloat(-infinity) .. 1.0, 0.006]


                   [2.5, -20.0, 5.0, 1.0000, 5.383]


                      /
                     |
                     |            -86 /   1    \1.7500
  [2.5, -20.0, 5.0,  |  0.27078 10    |--------|
                     |                |       2|
                     |                \2.5 + x /
                     |
                    /

        /                             /         1/2 /   1    \1/2\j\
        |infinity GAMMA(1.7500 + j/2) |-20.0 x 2    |--------|   | |
        | -----                       |             |       2|   | |
        |  \                          \             \2.5 + x /   / |
        |   )     -------------------------------------------------|
        |  /                        GAMMA(j + 1)                   |
        | -----                                                    |
        \ j = 0                                                    /

        dFloat(-infinity) .. 5.0, 0.004]

Warning, computation interrupted

> 
> evalf[25](subs(nu=5,delta=4,x=1,{Pdf2,Pdf}));

    {0.006980290614366408322393142, 0.006980290614366408322393150}

> plot(evalf[5](subs(nu=25,delta=4,{Pdf2,Pdf})),x=-10..20);

> A:=-10:
> B:=50:
> mu:=evalf[10](Int(x*subs(nu=25,delta=4,Pdf2),x=A..B));
> mu2:=evalf[10](Int((x-mu)^2*subs(nu=25,delta=4,Pdf),x=A..B));
> mu3:=evalf[10](Int((x-mu)^3*subs(nu=25,delta=4,Pdf),x=A..B));
> mu4:=evalf[10](Int((x-mu)^4*subs(nu=25,delta=4,Pdf),x=A..B));

           50.
          /
         |
         |
  mu :=  |     412188.2148 x
         |
         |
         |
        /
          -10.

        /                         /     1/2 /   1   \1/2\j\
        |infinity GAMMA(13 + j/2) |4 x 2    |-------|   | |
        | -----                   |         |      2|   | |
        |  \                      \         \25 + x /   / |   /
        |   )     ----------------------------------------|  /
        |  /                    GAMMA(j + 1)              | /
        | -----                                           |
        \ j = 0                                           /

                2 13
        (25. + x )   dx


            50.
           /                      /          50.
          |                       |         /
          |                       |        |
          |                    24 |        |
  mu2 :=  |     0.3377273976 10   |x - 1.  |     412188.2148 x
          |                       |        |
          |                       |        |
          |                       |        |
          |                       |       /
         /                        \         -10.
           -10.

        /                         /     1/2 /   1   \1/2\j\
        |infinity GAMMA(13 + j/2) |4 x 2    |-------|   | |
        | -----                   |         |      2|   | |
        |  \                      \         \25 + x /   / |   /
        |   )     ----------------------------------------|  /
        |  /                    GAMMA(j + 1)              | /
        | -----                                           |
        \ j = 0                                           /

                       \2
                       |
                       |  /
                2 13   |  |               -7
        (25. + x )   dx|  |0.1180967714 10   x
                       |  |
                       |  \
                       |
                       |
                       /

                                                       2
                                                  16. x        /
        hypergeom([13.50000000], [1.500000000], -----------)  /  (
                                                          2  /
                                                50. + 2. x

               2                   -9
        25. + x ) + 0.5846100010 10

                                                2
                                           16. x        /
        hypergeom([13.], [0.5000000000], -----------)  /
                                                   2  /
                                         50. + 2. x

                     \
                2 1/2|   /         2 25/2
        (25. + x )   |  /  (25. + x )     dx
                     | /
                     /


            50.
           /                      /          50.
          |                       |         /
          |                       |        |
          |                    24 |        |
  mu3 :=  |     0.3377273976 10   |x - 1.  |     412188.2148 x
          |                       |        |
          |                       |        |
          |                       |        |
          |                       |       /
         /                        \         -10.
           -10.

        /                         /     1/2 /   1   \1/2\j\
        |infinity GAMMA(13 + j/2) |4 x 2    |-------|   | |
        | -----                   |         |      2|   | |
        |  \                      \         \25 + x /   / |   /
        |   )     ----------------------------------------|  /
        |  /                    GAMMA(j + 1)              | /
        | -----                                           |
        \ j = 0                                           /

                       \3
                       |
                       |  /
                2 13   |  |               -7
        (25. + x )   dx|  |0.1180967714 10   x
                       |  |
                       |  \
                       |
                       |
                       /

                                                       2
                                                  16. x        /
        hypergeom([13.50000000], [1.500000000], -----------)  /  (
                                                          2  /
                                                50. + 2. x

               2                   -9
        25. + x ) + 0.5846100010 10

                                                2
                                           16. x        /
        hypergeom([13.], [0.5000000000], -----------)  /
                                                   2  /
                                         50. + 2. x

                     \
                2 1/2|   /         2 25/2
        (25. + x )   |  /  (25. + x )     dx
                     | /
                     /


            50.
           /                      /          50.
          |                       |         /
          |                       |        |
          |                    24 |        |
  mu4 :=  |     0.3377273976 10   |x - 1.  |     412188.2148 x
          |                       |        |
          |                       |        |
          |                       |        |
          |                       |       /
         /                        \         -10.
           -10.

        /                         /     1/2 /   1   \1/2\j\
        |infinity GAMMA(13 + j/2) |4 x 2    |-------|   | |
        | -----                   |         |      2|   | |
        |  \                      \         \25 + x /   / |   /
        |   )     ----------------------------------------|  /
        |  /                    GAMMA(j + 1)              | /
        | -----                                           |
        \ j = 0                                           /

                       \4
                       |
                       |  /
                2 13   |  |               -7
        (25. + x )   dx|  |0.1180967714 10   x
                       |  |
                       |  \
                       |
                       |
                       /

                                                       2
                                                  16. x        /
        hypergeom([13.50000000], [1.500000000], -----------)  /  (
                                                          2  /
                                                50. + 2. x

               2                   -9
        25. + x ) + 0.5846100010 10

                                                2
                                           16. x        /
        hypergeom([13.], [0.5000000000], -----------)  /
                                                   2  /
                                         50. + 2. x

                     \
                2 1/2|   /         2 25/2
        (25. + x )   |  /  (25. + x )     dx
                     | /
                     /

> evalf[25](int(subs(nu=25,delta=4,Pdf2),x=-39..39));

     39.
    /
   |
   |
   |     412188.2147739712713465529
   |
   |
   |
  /
    -39.

        /                         /     1/2 /   1   \1/2\j\
        |infinity GAMMA(13 + j/2) |4 x 2    |-------|   | |
        | -----                   |         |      2|   | |
        |  \                      \         \25 + x /   / |   /
        |   )     ----------------------------------------|  /
        |  /                    GAMMA(j + 1)              | /
        | -----                                           |
        \ j = 0                                           /

                2 13
        (25. + x )   dx

> plot(evalf[10](int(subs(nu=5,delta=4,P),x=-infinity..t)),t=-10..10);
> delta2:=delta*delta:
> mup1:=sqrt(nu_/2)*GAMMA((nu_-1)/2)/GAMMA(nu_/2)*delta+gamma_;
> mu1:=mup1-gamma_;
> mu2:=nu_ / (nu_ - 2) * (1 + delta * delta) - mu1 * mu1;
> mu4:=collect((nu_ * nu_ * (3 + 6 * delta2 + delta2 * delta2) / ((nu_ -
> 2) * (nu_ - 4)) - mup1 * mup1 * (nu_ * ((nu_ + 1) * delta2 + 3 * (3 *
> nu_ - 5))) / ((nu_ - 2) * (nu_ - 4)) - 3 * mu2),delta);
> evalf[25](1/sqrt(2));


                    1/2    1/2       nu_
                   2    nu_    GAMMA(--- - 1/2) delta
                                      2
       mup1 := 1/2 ---------------------------------- + gamma_
                                     nu_
                               GAMMA(---)
                                      2


                        1/2    1/2       nu_
                       2    nu_    GAMMA(--- - 1/2) delta
                                          2
            mu1 := 1/2 ----------------------------------
                                         nu_
                                   GAMMA(---)
                                          2


                                              nu_       2      2
                           2        nu_ GAMMA(--- - 1/2)  delta
             nu_ (1 + delta )                  2
      mu2 := ---------------- - 1/2 ----------------------------
                 nu_ - 2                          nu_ 2
                                            GAMMA(---)
                                                   2


  mu4 :=

        /        2       nu_       2                                \
        |     nu_  GAMMA(--- - 1/2)  (nu_ + 1)             2        |
        |                 2                             nu_         |
        |-1/2 -------------------------------- + -------------------|
        |           nu_ 2                        (nu_ - 2) (nu_ - 4)|
        |     GAMMA(---)  (nu_ - 2) (nu_ - 4)                       |
        \            2                                              /

                         1/2    3/2       nu_                       3
                 gamma_ 2    nu_    GAMMA(--- - 1/2) (nu_ + 1) delta
             4                             2
        delta  - ----------------------------------------------------
                                  nu_
                            GAMMA(---) (nu_ - 2) (nu_ - 4)
                                   2

           /                                    nu_       2   /
           |           2              nu_ GAMMA(--- - 1/2)    |
           |      6 nu_                          2            |
         + |------------------- + 3/2 --------------------- - |
           |(nu_ - 2) (nu_ - 4)                  nu_ 2        |
           |                               GAMMA(---)         |
           \                                      2           \

              2
        gamma_  nu_ (nu_ + 1)

                  2       nu_       2             \
               nu_  GAMMA(--- - 1/2)  (9 nu_ - 15)|
                           2                      |
         + 1/2 -----------------------------------|/((nu_ - 2)
                                 nu_ 2            |
                           GAMMA(---)             |
                                  2               /

                            \
                            |
                      3 nu_ |      2
        (nu_ - 4)) - -------| delta
                     nu_ - 2|
                            |
                            /

                   1/2    3/2       nu_
           gamma_ 2    nu_    GAMMA(--- - 1/2) (9 nu_ - 15) delta
                                     2
         - ------------------------------------------------------
                             nu_
                       GAMMA(---) (nu_ - 2) (nu_ - 4)
                              2

                      2                2
                 3 nu_           gamma_  nu_ (9 nu_ - 15)    3 nu_
         + ------------------- - ------------------------ - -------
           (nu_ - 2) (nu_ - 4)     (nu_ - 2) (nu_ - 4)      nu_ - 2


                     0.7071067811865475244008445

> factor((3+6/(nu-4))*(nu/(nu-2))^2);

                                    2
                                3 nu
                          -----------------
                          (nu - 2) (nu - 4)

> restart:
> Digits:=25:
> z:=delta^2*x^2/(2*(nu+x^2)):
> Pdf:=nu^(nu/2)*GAMMA(nu+1)/(2^nu*exp(delta^2/2)*(nu+x^2)^(nu/2)*GAMMA(
> nu/2))*(sqrt(2)*delta*x*hypergeom([nu/2+1],[3/2],z)/((nu+x^2)*GAMMA((n
> u+1)/2))+hypergeom([(nu+1)/2],[1/2],z)/(sqrt(nu+x^2)*GAMMA(nu/2+1)));
> GAM:=proc(x)
>   log(Pi*(2*x+1/3))/2+x*log(x)-x
> end:
> K:=GAM((nu+j+1)/2)-GAM(j+1)+j*log(X);

                                /
                                |
           / nu \               |
           |----|               |
           \ 2  /               |
  Pdf := nu       GAMMA(nu + 1) |
                                |
                                |
                                \

                                                        2  2
         1/2                     nu                delta  x
        2    delta x hypergeom([---- + 1], [3/2], -----------)
                                 2                          2
                                                  2 nu + 2 x
        ------------------------------------------------------
                            2         nu
                     (nu + x ) GAMMA(---- + 1/2)
                                      2

                                                2  2  \
                       nu                  delta  x   |     /
           hypergeom([---- + 1/2], [1/2], -----------)|     |
                       2                            2 |     |
                                          2 nu + 2 x  |   / | nu
         + -------------------------------------------|  /  |2
                         2 1/2        nu              | /   \
                  (nu + x )    GAMMA(---- + 1)        |
                                      2               /

                             / nu \            \
                             |----|            |
                 2           \ 2  /            |
            delta          2               nu  |
        exp(------) (nu + x )       GAMMA(----)|
              2                            2   /


  K := 1/2 ln(Pi (nu + j + 4/3))

           / nu             \     nu                  nu
         + |---- + j/2 + 1/2| ln(---- + j/2 + 1/2) - ---- + j/2 + 1/2
           \ 2              /     2                   2

         - 1/2 ln(Pi (2 j + 7/3)) - (j + 1) ln(j + 1) + j ln(X)

> KK:=log(GAMMA((nu+j+1)/2)/GAMMA(j+1)*X^j);
> P:=collect(convert(series(K,j=infinity,1),polynom),j);
> Q:=(1/2-1/2*ln(2)-1/2*ln(j)+ln(X))*j;
> solve(diff(P,j),j);
> solve(diff(Q,j),j);

                                 nu                j
                          GAMMA(---- + j/2 + 1/2) X
                                 2
                 KK := ln(--------------------------)
                                 GAMMA(j + 1)


             P := (1/2 - 1/2 ln(2) - 1/2 ln(j) + ln(X)) j


             Q := (1/2 - 1/2 ln(2) - 1/2 ln(j) + ln(X)) j


                                   2
                                  X
                                 ----
                                  2


                                   2
                                  X
                                 ----
                                  2

> plot(subs(nu=5,X=2.3,{P,KK,Q}),j=1..100);

> solve(diff(P0,j),j);

                                  j

> Kj:=GAMMA((nu+j+1)/2)/GAMMA(j+1)*X^j;
> P_i:=subs(j=2*i,Kj);
> Q_i:=subs(j=2*i+1,Kj);
> P_i_b:=subs(i=i-1,P_i):
> Q_i_b:=subs(i=i-1,Q_i):
> ratio_P_i_b:=simplify(factor(P_i_b/P_i));
> ratio_Q_i_b:=simplify(factor(Q_i_b/Q_i));
> P_i_f:=subs(i=i+1,P_i):
> Q_i_f:=subs(i=i+1,Q_i):
> ratio_P_i_f:=simplify(factor(P_i_f/P_i));
> ratio_Q_i_f:=simplify(factor(Q_i_f/Q_i));

                                nu                j
                         GAMMA(---- + j/2 + 1/2) X
                                2
                   Kj := --------------------------
                                GAMMA(j + 1)


                               nu              (2 i)
                        GAMMA(---- + i + 1/2) X
                               2
                 P_i := ----------------------------
                               GAMMA(2 i + 1)


                              nu            (2 i + 1)
                       GAMMA(---- + i + 1) X
                              2
                Q_i := ------------------------------
                               GAMMA(2 i + 2)


                                    4 (2 i - 1) i
                   ratio_P_i_b := -----------------
                                   2
                                  X  (nu + 2 i - 1)


                                    4 i (2 i + 1)
                     ratio_Q_i_b := -------------
                                     2
                                    X  (nu + 2 i)


                                   2
                                  X  (nu + 2 i + 1)
                  ratio_P_i_f := -------------------
                                 4 (2 i + 1) (i + 1)


                                   2
                                  X  (nu + 2 i + 2)
                  ratio_Q_i_f := -------------------
                                 4 (i + 1) (2 i + 3)

> subs(j=2*k,simplify(factor(subs(j=j+2,Kj)/Kj)));
> subs(j=2*k+1,simplify(factor(subs(j=j+2,Kj)/Kj)));

                           2
                          X  (nu + 2 k + 1)
                        ---------------------
                        2 (2 k + 1) (2 k + 2)


                           2
                          X  (nu + 2 k + 2)
                        ---------------------
                        2 (2 k + 2) (2 k + 3)

> val_ref:=evalf[25](subs(nu=5,delta=4,x=1,Pdf));
> y:=evalf[25](subs(nu=5,delta=4,x=1,x*delta*sqrt(2)/sqrt(nu+x*x)));
> fact:=evalf(subs(nu=5,delta=4,x=1,exp(-delta^2/2)/sqrt(nu*Pi)/GAMMA(nu
> /2)*(nu/(nu+x*x))^((nu+1)/2)));
> sum_:=0:
> for j from 0 to 10 do
> ds:=evalf[25](subs(nu=5,delta=4,x=1,GAMMA((nu+j+1)/2)/GAMMA(j+1)*y^j))
> :
> sum_:=sum_+ds:
> val:=sum_*fact;
> print([j,ds,sum_,val]);
> od:

               val_ref := 0.006980290614366408322393142


                   y := 2.309401076758503058036595


               fact := 0.00003684718105822560105314392


            [0, 2.0, 2.0, 0.00007369436211645120210628784]


  [1, 7.674950309598663663596637, 9.674950309598663663596637,

        0.0003564946457871177943063514]


  [2, 16.00000000000000000000000, 25.67495030959866366359664,

        0.0009460495427187274111566543]


  [3, 23.87762318541806473118953, 49.55257349501672839478617,

        0.001825872647471912364667963]


  [4, 28.44444444444444444444444, 77.99701793946117283923061,

        0.002873970242016996127957390]


  [5, 28.65314782250167767742743, 106.6501657619628505166580,

        0.003929757967720818072170959]


  [6, 25.28395061728395061728395, 131.9341163792468011339420,

        0.004861400273983114750650451]


  [7, 20.01172228873133044137789, 151.9458386679781315753199,

        0.005598775828442926902164691]


  [8, 14.44797178130511463844796, 166.3938104492832462137679,

        0.006131142860592810718438687]


  [9, 9.635273694574344286589355, 176.0290841438575905003573,

        0.006486175534962349902501100]


  [10, 5.993232738911751257430267, 182.0223168827693417577876,

        0.006707009266817116522585129]

> j:='j':
> evalf(1/2*exp(2*1));
> plot(subs(nu=5,delta=4,x=1,GAMMA((nu+j+1)/2)/GAMMA(j+1)*(x*delta*sqrt(
> 2)/sqrt(nu+x*x))^j),j=0..10);

                             3.694528050


> series(GAMMA((nu+j+1)/2)/GAMMA(j+1)*(x*delta*sqrt(2)/sqrt(nu+x*x))^j,j
> =infinity);
Error, (in asympt) unable to compute series

> 25.28395063/28.44444446;

                             0.8888888888

> subs(X=y,nu=5,i=2,1/4*X^2*(nu+2*i+1)/(2*i+1)/(i+1));

                             0.8888888893

> subs(kf=2,nu=5,(nu + 2.0 * kf + 1.0) / ((2.0 * kf + 1.0) * (kf +
> 1.0)))*1.33333333;

                             0.8888888868

> (28.4444/18.963)^(-1);

                             0.6666690102

> 
> 
