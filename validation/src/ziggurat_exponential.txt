> restart:
> st:=time();
> #Digits:=30:
> with(linalg):
> f:=exp(-t);
> invf:=solve(subs(t=u,f)=t,u);
> N:=128:
> z:=proc(r)
>      local x,v,i;
>      x:=vector(N);
>      x[N]:=r;
>      v:=r*subs(t=r,f)+int(f,t=r..infinity);
>      for i from N-1 by -1 to 1 do
>        x[i]:=subs(t=v/x[i+1]+subs(t=x[i+1],f),invf);
>      od:
>      return (v-x[1]+x[1]*subs(t=x[1],f));
> end:
> points:=proc(r)
>      local x,v,i;
>      x:=vector(N);
>      x[N]:=r;
>      v:=evalhf(r*subs(t=r,f)+int(f,t=r..infinity));
>      for i from N-1 by -1 to 1 do
>        x[i]:=evalhf(subs(t=v/x[i+1]+subs(t=x[i+1],f),invf));
>      od:
>      return evalhf(x);
> end:

                            st := 406.278


                             f := exp(-t)


                            invf := -ln(t)

> plot(z(r),r=4..10,numpoints=11);
> 
> eps:=1e-20:
> rmin:=5:
> zmin:=evalf(z(rmin)):
> continue:=true;
> step:=0.001:
> while continue do
>   while (Im(zmin) <> 0) do
>     rmin:=rmin+step;
>     zmin:=evalf(z(rmin)):
>     print([rmin,zmin]);
>   od:
>   step:=step*0.5;
>   while ((zmin<0) and (Im(zmin) = 0.0)) do
>     print([rmin,zmin]);
>     rmin:=rmin-step;
>     zmin:=evalf(z(rmin)):
>   od:
>   continue:=Im(zmin)<>0;
> od:
> rmax:=3.54:
> zmax:=evalf(z(rmax)):
> while (rmax-rmin>eps) do
>   m:=0.5*(rmax+rmin);
>   zm:=evalf(z(m));
>   if zm*zmin>0 then
>     rmin:=m;
>     zmin:=zm;
>   else
>     rmax:=m;
>     zmax:=zm;
>   fi:
>   print([m,zm]);
> od:
> r:=0.5*(rmin+rmax);
> v:=evalf(r*subs(t=r,f)+int(f,t=r..infinity));
> evalf(100*(1-int(f,t=0..infinity)/v/(N+1)));
> time()-st;

                           continue := true


              [3.530, -0.009996615052390796230642262915]


             [3.5250, -0.003575743608321455831059585809]


             [3.52250, -0.000385964273220764610730979812]


             [3.521250, 0.001203626343808462848477329275]


            [3.5218750, 0.000409276727465453135234206327]


            [3.52218750, 0.000011767339979993585170327073]


           [3.522343750, -0.000187070727064630593432329263]


          [3.5222656250, -0.000087644753826144721517271541]


          [3.52222656250, -0.000037936971390182178795111643]


         [3.522207031250, -0.000013084381746361836172193567]


                                                         -6
         [3.5221972656250, -0.658412384060628573420625 10  ]


                                                          -5
         [3.52219238281250, 0.5554490923927509186302203 10  ]


                                                          -5
        [3.522194824218750, 0.2448046051276173582805919 10  ]


                                                          -6
        [3.5221960449218750, 0.894818528925015693662357 10  ]


                                                           -6
        [3.52219665527343750, 0.118203496259199367696041 10  ]


                                                            -6
       [3.522196960449218750, -0.270104337944251273014537 10  ]


                                                            -7
       [3.5221968078613281250, -0.75950394353374105015769 10  ]


                                                            -7
       [3.52219673156738281250, 0.21126557575205095155201 10  ]


                                                             -7
      [3.522196769714355468750, -0.27411916733511951714843 10  ]


                                                             -8
      [3.5221967506408691406250, -0.3142679165260219633683 10  ]


                                                             -8
      [3.52219674110412597656250, 0.8991939308445748715070 10  ]


                                                             -8
     [3.522196745872497558593750, 0.2924630097461091180186 10  ]


                                                              -9
     [3.5221967482566833496093750, -0.109024527432482704266 10  ]


                                                              -8
    [3.52219674706459045410156250, 0.1407802786631074635745 10  ]


                                                              -9
    [3.522196747660636901855468750, 0.649389130003488563040 10  ]


                                                               -9
    [3.5221967479586601257324218750, 0.270182301386551078447 10  ]


                                                              -10
   [3.52219674810767173767089843750, 0.80578887002296224309 10   ]


                                                               -10
   [3.52219674818217754364013671875, -0.14222820208777730680 10   ]


                                                              -10
   [3.52219674814492464065551757813, 0.33178033398338124134 10   ]


                                                              -11
    [3.52219674816355109214782714844, 0.9477606595174916066 10   ]


                                                              -11
   [3.52219674817286431789398193360, -0.2372606806702727477 10   ]


                                                              -11
    [3.52219674816820770502090454102, 0.3552499894260764244 10   ]


                                                             -12
    [3.52219674817053601145744323731, 0.589946543785185883 10   ]


                                                              -12
    [3.52219674817170016467571258546, -0.891330131457228925 10   ]


                                                              -12
    [3.52219674817111808806657791139, -0.150691793835636074 10   ]


                                                             -12
    [3.52219674817082704976201057436, 0.219627374974871256 10   ]


                                                             -13
     [3.52219674817097256891429424288, 0.34467790569641682 10   ]


                                                             -13
    [3.52219674817104532849043607714, -0.58112001632991178 10   ]


                                                             -13
    [3.52219674817100894870236516001, -0.11822105531673240 10   ]


                                                             -13
     [3.52219674817099075880832970144, 0.11322842518984600 10   ]


                                                            -15
     [3.52219674817099985375534743072, -0.249631506344221 10   ]


                                                            -14
     [3.52219674817099530628183856608, 0.5536605506320220 10   ]


                                                            -14
     [3.52219674817099758001859299840, 0.2643486999988011 10   ]


                                                            -14
     [3.52219674817099871688697021456, 0.1196927746821897 10   ]


                                                            -15
      [3.52219674817099928532115882264, 0.473648120238844 10   ]


                                                            -15
      [3.52219674817099956953825312668, 0.112008306947303 10   ]


                                                            -16
      [3.52219674817099971164680027870, -0.68811599698455 10   ]


                                                           -16
      [3.52219674817099964059252670269, 0.21598353624427 10   ]


                                                            -16
      [3.52219674817099967611966349069, -0.23606623037013 10   ]


                                                           -17
      [3.52219674817099965835609509668, -0.1004134706276 10   ]


                                                           -16
      [3.52219674817099964947431089968, 0.10297109459075 10   ]


                                                           -17
       [3.52219674817099965391520299818, 0.4646487376402 10   ]


                                                           -17
       [3.52219674817099965613564904743, 0.1821176335063 10   ]


                                                          -18
       [3.52219674817099965724587207206, 0.408520814396 10   ]


                                                           -18
       [3.52219674817099965780098358437, -0.297806945947 10   ]


                                                          -19
        [3.52219674817099965752342782821, 0.55356934228 10   ]


                                                           -18
       [3.52219674817099965766220570628, -0.121225005847 10   ]


                                                          -19
       [3.52219674817099965759281676724, -0.32934035805 10   ]


                                                          -19
        [3.52219674817099965755812229772, 0.11211449217 10   ]


                                                          -19
       [3.52219674817099965757546953248, -0.10861293301 10   ]


                                                         -21
         [3.52219674817099965756679591510, 0.175077968 10   ]


                 r := 3.52219674817099965757113272379


                v := 0.133560747637524809979865897762


                   16.8085585948804012202695238118


                                84.286

> t:=points(r):
> y:=vector(N+2):
> y[1]:=0:
> for i from 2 to N+1 do
>   y[i]:=t[i-1];
> od:
> y[N+2]:=evalf(v/subs(t=r,f)):
> z:=vector(N+1):
> for i from 1 to N+1 do
>   z[i]:=y[i]/y[i+1];
> od:
> print(z);

  [0., 0.750484775353838553484969850043,

        0.850740271310955168539797476445,

        0.893433541969631939167066002439,

        0.917015181837094471851335493153,

        0.931941203234046233441298028733,

        0.942225689827803086945282581056,

        0.949736532992396229158449917333,

        0.955459380775071654971678008833,

        0.959962976643589437257667346996,

        0.963598275031758611303047864447,

        0.966593473467949497522283939333,

        0.969103315737874152720557392852,

        0.971236417555650662146408519772,

        0.973071247290683962507094254337,

        0.974665898140297597377304564176,

        0.976064293086860561017929573224,

        0.977300253883645249170475123945,

        0.978400244899316179173188425569,

        0.979385269129977846895884043302,

        0.980272206900904494815390564396,

        0.981074779362329241400634997295,

        0.981804253938740083291033345358,

        0.982469968882383589521668758583,

        0.983079728809119850562796554795,

        0.983640106766412054356146072398,

        0.984156677615944084392929857459,

        0.984634200280007552311796735515,

        0.985076761458307086707253212313,

        0.985487889991653471429663256532,

        0.985870648634019490358385815715,

        0.986227708271493343086583402375,

        0.986561408382272362985077361984,

        0.986873806622761920341336293274,

        0.987166719753625799389459567589,

        0.987441757619090675912393772106,

        0.987700351516051174211224554768,

        0.987943778003453440265050048019,

        0.988173178983434816520165815368,

        0.988389578716739479383699175238,

        0.988593898303624926534040096469,

        0.988786968058724293246032191279,

        0.988969538127397455898436508912,

        0.989142287626960404173170844597,

        0.989305832545044324977737622638,

        0.989460732586336934407985727862,

        0.989607497125912170683173044980,

        0.989746590400581327272272451975,

        0.989878436047901646747803160708,

        0.990003421084648827869197604239,

        0.990121899401909443020286447879,

        0.990234194841858232813880454444,

        0.990340603911263982506239462637,

        0.990441398178427316016322972125,

        0.990536826393283914925721684389,

        0.990627116364558512218324337623,

        0.990712476622928023181406791844,

        0.990793097894984079572175093174,

        0.990869154409244076145976128873,

        0.990940805052437824691268287474,

        0.991008194391705548082954937064,

        0.991071453576109215637707296064,

        0.991130701128922528307152229819,

        0.991186043640474608746669498017,

        0.991237576369836074033189634373,

        0.991285383762317554082871105898,

        0.991329539888568903748275039752,

        0.991370108809995454035219189473,

        0.991407144874221943150024047055,

        0.991440692943413945013043999353,

        0.991470788557391074579718311726,

        0.991497458032617503483410551001,

        0.991520718497315401540555107636,

        0.991540577862097828628588285611,

        0.991557034724640724341601679445,

        0.991570078205989141038468359572,

        0.991579687715098995526722137843,

        0.991585832637127947522049524329,

        0.991588471939779518821684067585,

        0.991587553690640507148992013935,

        0.991583014476894319513703858007,

        0.991574778716995497249215923087,

        0.991562757851797002828992213523,

        0.991546849400162799407295751574,

        0.991526935861188886574791544186,

        0.991502883441690831444489168144,

        0.991474540583463335923580694623,

        0.991441736259812196096950028863,

        0.991404278004792265983740672627,

        0.991361949631191261607889802980,

        0.991314508584238996353362687132,

        0.991261682866858262508333044405,

        0.991203167458441781253777050367,

        0.991138620131902842410876661610,

        0.991067656552139074390092217899,

        0.990989844511792319927328343055,

        0.990904697125582941945109300521,

        0.990811664760263111407350456154,

        0.990710125420284608160345942834,

        0.990599373235399951429113359060,

        0.990478604599807611123088277090,

        0.990346901385037190355276297326,

        0.990203210479193398963460161789,

        0.990046318677290513694722835952,

        0.989874821637971854574784332163,

        0.989687085197041986702889368351,

        0.989481196737866229216740827939,

        0.989254903487686985183950871399,

        0.989005533422740516025904697311,

        0.988729892746066823168948592841,

        0.988424131369219266125861236354,

        0.988083564029399232263953634600,

        0.987702428858508882825722518646,

        0.987273556123533683467427764224,

        0.986787905274353495741507623455,

        0.986233904410023291038018271182,

        0.985596485459788251551070665927,

        0.984855636576794042676975880029,

        0.983984161793717454104724720040,

        0.982944085941803527491004884902,

        0.981680632603656288469381808499,

        0.980111601026471711171610577703,

        0.978107394117398550145114447318,

        0.975450319596402797690182574081,

        0.971742413337712360174408714492,

        0.966163908091604482763906551568,

        0.956686237014236193571274296719,

        0.936329102386070277297433094023,

        0.927249206800360320095099544455]

> writeto("zigAbs.txt");print(y);writeto("zigRat.txt");print(z);writeto(
> terminal);
> vector([.69828363320908991, .78118354989999061, .79370592389489407,
> 0]);

  [0.69828363320908991, 0.78118354989999061, 0.79370592389489407, 0]

> vector([.75048477535383857, .85074027131095516, .89343354196963194,
> .91701518183709447, .93194120323404624, .94222568982780309,
> .94973653299239623, .95545938077507166, .95996297664358943,
> .96359827503175862, .96659347346794949, .96910331573787415,
> .97123641755565066, .97307124729068396, .97466589814029760,
> .97606429308686056, .97730025388364525, .97840024489931618,
> .97938526912997784, .98027220690090450, .98107477936232924,
> .98180425393874008, .98246996888238359, .98307972880911985,
> .98364010676641205, .98415667761594405, .98463420028000756,
> .98507676145830715, .98548788999165345, .98587064863401946,
> .98622770827149339, .98656140838227233, .98687380662276195,
> .98716671975362574, .98744175761909067, .98770035151605120,
> .98794377800345342, .98817317898343486, .98838957871673949,
> .98859389830362490, .98878696805872424, .98896953812739748,
> .98914228762696040, .98930583254504435, .98946073258633692,
> .98960749712591216, .98974659040058136, .98987843604790162,
> .99000342108464880, .99012189940190944, .99023419484185828,
> .99034060391126399, .99044139817842731, .99053682639328391,
> .99062711636455849, .99071247662292805, .99079309789498403,
> .99086915440924409, .99094080505243783, .99100819439170557,
> .99107145357610920, .99113070112892251, .99118604364047460,
> .99123757636983612, .99128538376231757, .99132953988856886,
> .99137010880999548, .99140714487422192, .99144069294341396,
> .99147078855739107, .99149745803261747, .99152071849731542,
> .99154057786209781, .99155703472464074, .99157007820598915,
> .99157968771509899, .99158583263712792, .99158847193977956,
> .99158755369064052, .99158301447689427, .99157477871699552,
> .99156275785179700, .99154684940016281, .99152693586118888,
> .99150288344169082, .99147454058346333, .99144173625981221,
> .99140427800479225, .99136194963119127, .99131450858423899,
> .99126168286685828, .99120316745844180, .99113862013190281,
> .99106765655213910, .99098984451179232, .99090469712558292,
> .99081166476026313, .99071012542028460, .99059937323539995,
> .99047860459980760, .99034690138503720, .99020321047919340,
> .99004631867729052, .98987482163797186, .98968708519704195,
> .98948119673786624, .98925490348768697, .98900553342274055,
> .98872989274606682, .98842413136921927, .98808356402939922,
> .98770242885850886, .98727355612353372, .98678790527435347,
> .98623390441002328, .98559648545978825, .98485563657679404,
> .98398416179371746, .98294408594180356, .98168063260365628,
> .98011160102647170, .97810739411739857, .97545031959640279,
> .97174241333771234, .96616390809160447, .95668623701423621,
> .93632910238607026, 0]);

  [0.75048477535383857, 0.85074027131095516, 0.89343354196963194,

        0.91701518183709447, 0.93194120323404624, 0.94222568982780309,

        0.94973653299239623, 0.95545938077507166, 0.95996297664358943,

        0.96359827503175862, 0.96659347346794949, 0.96910331573787415,

        0.97123641755565066, 0.97307124729068396, 0.97466589814029760,

        0.97606429308686056, 0.97730025388364525, 0.97840024489931618,

        0.97938526912997784, 0.98027220690090450, 0.98107477936232924,

        0.98180425393874008, 0.98246996888238359, 0.98307972880911985,

        0.98364010676641205, 0.98415667761594405, 0.98463420028000756,

        0.98507676145830715, 0.98548788999165345, 0.98587064863401946,

        0.98622770827149339, 0.98656140838227233, 0.98687380662276195,

        0.98716671975362574, 0.98744175761909067, 0.98770035151605120,

        0.98794377800345342, 0.98817317898343486, 0.98838957871673949,

        0.98859389830362490, 0.98878696805872424, 0.98896953812739748,

        0.98914228762696040, 0.98930583254504435, 0.98946073258633692,

        0.98960749712591216, 0.98974659040058136, 0.98987843604790162,

        0.99000342108464880, 0.99012189940190944, 0.99023419484185828,

        0.99034060391126399, 0.99044139817842731, 0.99053682639328391,

        0.99062711636455849, 0.99071247662292805, 0.99079309789498403,

        0.99086915440924409, 0.99094080505243783, 0.99100819439170557,

        0.99107145357610920, 0.99113070112892251, 0.99118604364047460,

        0.99123757636983612, 0.99128538376231757, 0.99132953988856886,

        0.99137010880999548, 0.99140714487422192, 0.99144069294341396,

        0.99147078855739107, 0.99149745803261747, 0.99152071849731542,

        0.99154057786209781, 0.99155703472464074, 0.99157007820598915,

        0.99157968771509899, 0.99158583263712792, 0.99158847193977956,

        0.99158755369064052, 0.99158301447689427, 0.99157477871699552,

        0.99156275785179700, 0.99154684940016281, 0.99152693586118888,

        0.99150288344169082, 0.99147454058346333, 0.99144173625981221,

        0.99140427800479225, 0.99136194963119127, 0.99131450858423899,

        0.99126168286685828, 0.99120316745844180, 0.99113862013190281,

        0.99106765655213910, 0.99098984451179232, 0.99090469712558292,

        0.99081166476026313, 0.99071012542028460, 0.99059937323539995,

        0.99047860459980760, 0.99034690138503720, 0.99020321047919340,

        0.99004631867729052, 0.98987482163797186, 0.98968708519704195,

        0.98948119673786624, 0.98925490348768697, 0.98900553342274055,

        0.98872989274606682, 0.98842413136921927, 0.98808356402939922,

        0.98770242885850886, 0.98727355612353372, 0.98678790527435347,

        0.98623390441002328, 0.98559648545978825, 0.98485563657679404,

        0.98398416179371746, 0.98294408594180356, 0.98168063260365628,

        0.98011160102647170, 0.97810739411739857, 0.97545031959640279,

        0.97174241333771234, 0.96616390809160447, 0.95668623701423621,

        0.93632910238607026, 0]

> factor(int(3/4*(1-u^2),u=-1..t));

                                           2
                            (t - 2) (t + 1)
                          - ----------------
                                   4

> 
> 
